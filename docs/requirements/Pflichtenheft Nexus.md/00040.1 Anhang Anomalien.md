# Weitere ungewöhnliche Muster für die Anomalie-Erkennung

Diese Auflistung ist nicht zwingend bindend, gibt aber einen Überblick darüber wie man mögliche Angriffe früh erkennen kann.

1. Abnormale Anzahl fehlgeschlagener Requests pro Session
  - Viele 4xx-Antworten (z. B. 403, 429) in kurzer Zeit.
  - Viele Fehler bei geschützten Endpunkten (z. B. wiederholte CSRF-Verstöße).
  - Erhöhter Anteil invalidierter Tokens oder Nonces.

2. Plötzlich starke Verkürzung der Request-Abstände
  - Extrem schnelle, maschinell wirkende Request-Sequenzen (Bruteforce, Scripted Session Replay).
  - Ungewöhnlich viele Requests innerhalb weniger Sekunden.

3. Wechselnde Geo- oder ASN-Signaturen trotz stabiler IP
  - IP unter derselben Session bleibt ähnlich, aber ASN oder Geo-Signatur wechselt → typisch bei Proxies/VPN-Rotation. Wird oft bei Account Takeover mit kompromittierten Cookies beobachtet.

4. Wiederverwendete oder „zurückrollende“ Session-IDs
  - Derselbe Client versucht ältere Session-IDs zu nutzen.
  - Session-ID taucht mehrfach innerhalb kurzer Zeit auf verschiedenen User-Agents auf.

5. Auffällige User-Agent-Dynamik
  - Ungewöhnlich viele kleine Variationen des User-Agents innerhalb einer Session (z. B. Bots).
  - Wechsel des Rendering-Engines (Chrome → Firefox) innerhalb derselben Session.

6. Mehrere parallele Requests, die das erwartbare Nutzerverhalten überschreiten
  - z.B. 20+ parallele Requests für denselben Endpunkt → typisch für Scraper oder Replay-Angriffe.

7. Wiederholte Idle-Timeout-Grenzfälle
  - Client sendet jeweils genau kurz vor Timeout einen Request. Typisch für Bots, die Session künstlich am Leben halten.

8. Session-Aktivität aus mehreren Netzwerkpfaden
  - gleiche Session-ID kommt abwechselnd von IPv4 und IPv6 oder von mobilen und stationären Netzwerken im schnellen Wechsel.

9. Unerwartete Zeitmanipulationen
  - Client sendet mit Timezone-Headern, die ständig wechseln.
  - Request-Zeiten wirken rückwärtslaufend durch manuelle Header-Manipulation.

10. Häufige CSRF- oder Origin-Fehler
  - wiederholte ungültige Origin/Referer-Header deutet auf automatisierte Tools oder Cross-Site-Einbindung hin.

11. Übermäßig viele Invalidate-/Logout-Aufrufe
  - Kann auf Session-Stealing oder Bot-Interaktion hinweisen.

12. Starke Abweichung vom „üblichen“ Nutzerprofil
  - (z. B. per Heuristik, nicht ML) z. B. ein Account, der sonst 20 Requests pro Stunde macht, erzeugt plötzlich 2000.
  - stark wechselnde Endpunkte/URLs, die der Nutzer sonst nie nutzt.