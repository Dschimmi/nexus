; ==============================================================================
; NEXUS OPCACHE CONFIGURATION (TEMPLATE)
; ==============================================================================
; Diese Konfiguration dient als Referenz für die Produktionsumgebung.
; Sie sollte in die php.ini oder den conf.d-Ordner des Servers integriert werden.

[opcache]
; ------------------------------------------------------------------------------
; Basis-Einstellungen
; ------------------------------------------------------------------------------
opcache.enable=1
; CLI-Caching standardmäßig deaktivieren (verhindert Probleme bei CLI-Tools/Deployment)
opcache.enable_cli=0

; ------------------------------------------------------------------------------
; Speicher-Dimensionierung
; ------------------------------------------------------------------------------
; Reserviert 256MB Shared Memory (Enterprise-Standard für Symfony/Framework-Apps)
opcache.memory_consumption=256

; Speicher für interne Strings in MB (High-Traffic Optimierung)
opcache.interned_strings_buffer=16

; Maximale Anzahl an gecachten Skripten.
; Nexus + Vendor liegen typischerweise bei ~5k-8k Dateien. 20k bietet Puffer.
opcache.max_accelerated_files=20000

; ------------------------------------------------------------------------------
; Validierungs-Strategie (Produktion)
; ------------------------------------------------------------------------------
; 0 = Filesystem-Calls komplett einsparen. 
; Performance-Gewinn, erfordert aber Server-Reload/Cache-Flush bei jedem Deployment.
opcache.validate_timestamps=0

; Ignoriert, wenn validate_timestamps=0. Sonst: Prüfintervall in Sekunden.
opcache.revalidate_freq=0

; ------------------------------------------------------------------------------
; JIT Compiler (PHP 8 Feature)
; ------------------------------------------------------------------------------
; Tracing JIT (1255) ist für Webanwendungen meist der beste Kompromiss.
opcache.jit=1255
opcache.jit_buffer_size=64M

; ------------------------------------------------------------------------------
; Preloading
; ------------------------------------------------------------------------------
; Lädt essentielle Framework-Klassen beim Serverstart in den Speicher.
; HINWEIS: Der Pfad muss ein absoluter Systempfad zur config/preload.php sein.
; Bitte entsprechend der Deployment-Struktur aktivieren und anpassen.
;
; opcache.preload=/var/www/html/config/preload.php
; opcache.preload_user=www-data