{#
    Listenansicht der Dummy-Seiten mit Löschfunktion.
#}
{% extends 'base.html.twig' %}

{% block title %}{{ 'admin.pages_list_title'|trans }} – {{ parent() }}{% endblock %}

{% block content %}
{# Admin-CSS laden #}
<link rel="stylesheet" href="{{ asset('css/admin.css') }}">

<section class="card">
    <div class="u-flex u-justify-between u-items-center u-mb-4">
        <h1>{{ 'admin.pages_list_title'|trans }}</h1>
        <div class="u-flex u-gap-2">
            <a href="/admin" class="btn btn--outline btn--sm">Zurück</a>
            <a href="/admin/pages/create" class="btn btn--primary btn--sm">
                {{ 'admin.pages_btn_create'|trans }}
            </a>
        </div>
    </div>

    <div>
        <form action="/admin/pages/delete" method="post" id="deleteForm">
            
            {% if pages is empty %}
                <div class="u-text-center u-text-muted u-mb-4">
                    {{ 'admin.pages_empty'|trans }}
                </div>
            {% else %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="table__col-check">
                                <label class="checkbox-label" style="justify-content: center;">
                                    <input type="checkbox" id="selectAll" style="cursor: pointer;">
                                </label>
                            </th>
                            <th>{{ 'admin.pages_col_title'|trans }}</th>
                            <th>{{ 'admin.pages_col_slug'|trans }}</th>
                            <th class="table__col-actions">Link</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for page in pages %}
                            <tr>
                                <td class="table__col-check">
                                    <label class="checkbox-label" style="justify-content: center;">
                                        <input type="checkbox" name="slugs[]" value="{{ page.slug }}" class="page-checkbox">
                                    </label>
                                </td>
                                <td class="u-font-bold">
                                    {{ page.title }}
                                </td>
                                <td class="u-text-muted" style="font-family: monospace;">
                                    /{{ page.slug }}
                                </td>
                                <td class="table__col-actions">
                                    <a href="/{{ page.slug }}" target="_blank" class="btn btn--outline btn--sm">
                                        Vorschau
                                    </a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}

            {% if pages is not empty %}
                <div class="u-mt-4">
                    <button type="submit" class="btn btn--danger" onclick="return confirm('Wirklich löschen?');">
                        {{ 'admin.pages_btn_delete'|trans }}
                    </button>
                </div>
            {% endif %}
        </form>
    </div>
</section>

<script>
    
// "Alle auswählen" Logik
    document.getElementById('selectAll')?.addEventListener('change', function() {
        const checkboxes = document.querySelectorAll('.page-checkbox');
        for (const checkbox of checkboxes) {
            checkbox.checked = this.checked;
        }
    });
</script>
{% endblock %}