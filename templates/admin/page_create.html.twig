{#
    Formular zur Erstellung neuer Dummy-Seiten.
    Nutzt Standard-Komponenten aus components.css (.form-input, .btn).
#}
{% extends 'base.html.twig' %}

{% block title %}{{ 'admin.page_create_title'|trans }} – {{ parent() }}{% endblock %}

{% block content %}
<section class="card">
    
    {# Header: Flex-Layout via Utility-Klassen #}
    <div class="u-flex u-justify-between u-items-center u-mb-4">
        <h1>{{ 'admin.page_create_title'|trans }}</h1>
        <a href="/admin" class="btn btn--outline">Zurück zum Dashboard</a>
    </div>

    {# Inhalt in der Card #}
    <div>
        <form action="/admin/pages/create" method="post">
            
            {# Titel #}
            <div class="u-mb-4">
                <label for="title" class="u-block u-font-bold u-mb-1">
                    {{ 'admin.page_label_title'|trans }}
                </label>
                <input type="text" id="title" name="title" class="form-input" required oninput="generateSlug()">
            </div>

            {# Slug (URL) #}
            <div class="u-mb-4">
                <label for="slug" class="u-block u-font-bold u-mb-1">
                    {{ 'admin.page_label_slug'|trans }}
                </label>
                <div class="u-flex u-items-center u-gap-2">
                    <span class="u-text-muted">exelor.de/</span>
                    <input type="text" id="slug" name="slug" class="form-input" 
                           style="flex-grow: 1;"
                           required pattern="[a-z0-9-]+" title="Nur Kleinbuchstaben, Zahlen und Bindestriche erlaubt.">
                </div>
            </div>

            {# Inhalt #}
            <div class="u-mb-6">
                <label for="content" class="u-block u-font-bold u-mb-1">
                    {{ 'admin.page_label_content'|trans }}
                </label>
                <textarea id="content" name="content" rows="15" 
                          class="form-textarea" 
                          style="font-family: monospace;"
                          required></textarea>
            </div>

            {# Actions #}
            <div class="card__actions">
                <button type="submit" class="btn btn--primary">
                    {{ 'admin.page_btn_save'|trans }}
                </button>
            </div>
        </form>
    </div>
</section>

<script>
    /**
     * Generiert einen URL-freundlichen Slug aus dem Titel.
     */
    function generateSlug() {
        const title = document.getElementById('title').value;
        const slugInput = document.getElementById('slug');
        
        let slug = title.toLowerCase()
            .replace(/ä/g, 'ae')
            .replace(/ö/g, 'oe')
            .replace(/ü/g, 'ue')
            .replace(/ß/g, 'ss')
            .replace(/[^a-z0-9\s-]/g, '') 
            .trim()
            .replace(/\s+/g, '-');
        slugInput.value = slug;
    }
</script>
{% endblock %}